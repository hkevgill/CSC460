\hypertarget{os_8c}{}\section{/\+Users/kevingill/\+Git/\+C\+S\+C460/\+Project 3/rtos/os.c File Reference}
\label{os_8c}\index{/\+Users/kevingill/\+Git/\+C\+S\+C460/\+Project 3/rtos/os.\+c@{/\+Users/kevingill/\+Git/\+C\+S\+C460/\+Project 3/rtos/os.\+c}}
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$avr/io.\+h$>$}\\*
{\ttfamily \#include $<$avr/interrupt.\+h$>$}\\*
{\ttfamily \#include \char`\"{}os.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}queue.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{os_8c_ad72dbcf6d0153db1b8d8a58001feed83}{D\+E\+B\+UG}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{os_8c_af9c2d0fc011e8984b199e8255ffd9f96}{a\+\_\+main} ()
\item 
void \hyperlink{os_8c_a14f79e1bcaffbf0e0f2e6c4460a61d00}{C\+Switch} ()
\item 
void \hyperlink{os_8c_a754288f34793d6c04ab1e008276a8b2e}{Exit\+\_\+\+Kernel} ()
\item 
void \hyperlink{os_8c_aeb1fcf3f13ebc649c9882f07de88cf74}{Task\+\_\+\+Terminate} (void)
\item 
void \hyperlink{os_8c_a162ae3bf731cea07532b520836d1338f}{Enter\+\_\+\+Kernel} ()
\item 
\hyperlink{os_8h_aa4f4d03691545cda70a42801c8b9096b}{P\+ID} \hyperlink{os_8c_ad5a6d9c7b80973c260f856e76414c1de}{Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At} (volatile \hyperlink{os_8h_ad71fa550e6ad0b4ded3d147641b23d12}{PD} $\ast$p, \hyperlink{os_8h_afaa1ed37e5a81e2bcafd0ca0fee30da3}{voidfuncptr} f, \hyperlink{os_8h_ac7feb3cd411cb0c0924b0defb19127d4}{P\+R\+I\+O\+R\+I\+TY} py, int arg)
\item 
\hyperlink{os_8h_ad50a579691fc8233e549f1b355ef96b3}{M\+U\+T\+EX} \hyperlink{os_8c_a8b771ba833987e328124f40034de1e14}{Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At} (volatile \hyperlink{os_8h_adf13ad848f096dd6747c462f711fe829}{M\+TX} $\ast$m)
\item 
\hyperlink{os_8h_a3b95dbfce5db28a04d9387963a3f3708}{E\+V\+E\+NT} \hyperlink{os_8c_a7fb955365604100a332d2134acc35a1b}{Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At} (volatile \hyperlink{os_8h_af1b0aafef027c952563aac52da203bb1}{E\+VT} $\ast$e)
\item 
void \hyperlink{os_8c_a280149a9407c6504ce0af541351561db}{O\+S\+\_\+\+Init} ()
\item 
void \hyperlink{os_8c_ad962d6cd4a1df43af8ab0aabe2fd5e03}{O\+S\+\_\+\+Start} ()
\item 
void \hyperlink{os_8c_a40cd786f232d0c4af0952cfc037addc6}{O\+S\+\_\+\+Abort} ()
\item 
\hyperlink{os_8h_ad50a579691fc8233e549f1b355ef96b3}{M\+U\+T\+EX} \hyperlink{os_8c_a44779a076d3264dd26f83ae3e2434450}{Mutex\+\_\+\+Init} ()
\item 
void \hyperlink{os_8c_a192517b3428c686a32293805abd120f1}{Mutex\+\_\+\+Lock} (\hyperlink{os_8h_ad50a579691fc8233e549f1b355ef96b3}{M\+U\+T\+EX} m)
\item 
void \hyperlink{os_8c_ac614666cf2c6345ff7e15ceb2e96e8dc}{Mutex\+\_\+\+Unlock} (\hyperlink{os_8h_ad50a579691fc8233e549f1b355ef96b3}{M\+U\+T\+EX} m)
\item 
\hyperlink{os_8h_a3b95dbfce5db28a04d9387963a3f3708}{E\+V\+E\+NT} \hyperlink{os_8c_a804f05f767669c8c5ca3afb4b90d99e0}{Event\+\_\+\+Init} ()
\item 
void \hyperlink{os_8c_adc88c81b804bb7848bb39488ebdac6f9}{Event\+\_\+\+Wait} (\hyperlink{os_8h_a3b95dbfce5db28a04d9387963a3f3708}{E\+V\+E\+NT} e)
\item 
void \hyperlink{os_8c_a82948eaf2be7ba779203ac31df96e5b6}{Event\+\_\+\+Signal} (\hyperlink{os_8h_a3b95dbfce5db28a04d9387963a3f3708}{E\+V\+E\+NT} e)
\item 
\hyperlink{os_8h_aa4f4d03691545cda70a42801c8b9096b}{P\+ID} \hyperlink{os_8c_afed6faf3ae1b6be2a43f5f43c4e53250}{Task\+\_\+\+Create} (\hyperlink{os_8h_afaa1ed37e5a81e2bcafd0ca0fee30da3}{voidfuncptr} f, \hyperlink{os_8h_ac7feb3cd411cb0c0924b0defb19127d4}{P\+R\+I\+O\+R\+I\+TY} py, int arg)
\item 
void \hyperlink{os_8c_a5a9b72d0dadaea32fec8d4ff1c0eafa4}{Task\+\_\+\+Next} ()
\item 
void \hyperlink{os_8c_a312c9c8228404b24b021279387a7c774}{Task\+\_\+\+Sleep} (\hyperlink{os_8h_a8cc02cda8b6aacf20b067a28103f1e1a}{T\+I\+CK} t)
\item 
void \hyperlink{os_8c_a8d86c9b6abd886dc6dc8005808d219e6}{Task\+\_\+\+Suspend} (\hyperlink{os_8h_aa4f4d03691545cda70a42801c8b9096b}{P\+ID} p)
\item 
void \hyperlink{os_8c_a6bbdbd6cb63924353074e64134deff60}{Task\+\_\+\+Resume} (\hyperlink{os_8h_aa4f4d03691545cda70a42801c8b9096b}{P\+ID} p)
\item 
int \hyperlink{os_8c_ae9e552294bff300b4c4f4e5a010ee735}{Task\+\_\+\+Get\+Arg} (\hyperlink{os_8h_aa4f4d03691545cda70a42801c8b9096b}{P\+ID} p)
\item 
void \hyperlink{os_8c_a4fc01d736fe50cf5b977f755b675f11d}{setup} ()
\item 
\hyperlink{os_8c_ad39420cdd896dd12c68e36313139d0a5}{I\+SR} (T\+I\+M\+E\+R1\+\_\+\+C\+O\+M\+P\+A\+\_\+vect)
\item 
\hyperlink{os_8c_a86953738188622410b88938da2bf8a63}{I\+SR} (T\+I\+M\+E\+R3\+\_\+\+C\+O\+M\+P\+A\+\_\+vect)
\item 
void \hyperlink{os_8c_acdef7a1fd863a6d3770c1268cb06add3}{main} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile unsigned char $\ast$ \hyperlink{os_8c_a0841513918201502036fc51005a17411}{Kernel\+Sp}
\item 
volatile unsigned char $\ast$ \hyperlink{os_8c_a5f93aafc340cf74d6d1389f53cfdce23}{Current\+Sp}
\item 
volatile unsigned int \hyperlink{os_8c_a855e060cb1ab82756c5688c661ec7872}{tick\+Overflow\+Count} = 0
\item 
volatile \hyperlink{os_8h_ad71fa550e6ad0b4ded3d147641b23d12}{PD} $\ast$ \hyperlink{os_8c_a4a9c7eec21f25437a89e349d66608937}{Ready\+Queue} \mbox{[}\hyperlink{os_8h_a06227c0951b6668e376b70760f6ead76}{M\+A\+X\+T\+H\+R\+E\+AD}\mbox{]}
\item 
volatile int \hyperlink{os_8c_a96957c6dd13db4430799fff38a54f151}{R\+Q\+Count} = 0
\item 
volatile \hyperlink{os_8h_ad71fa550e6ad0b4ded3d147641b23d12}{PD} $\ast$ \hyperlink{os_8c_a94c6daa6fecf3677de9e1471e294baa6}{Sleep\+Queue} \mbox{[}\hyperlink{os_8h_a06227c0951b6668e376b70760f6ead76}{M\+A\+X\+T\+H\+R\+E\+AD}\mbox{]}
\item 
volatile int \hyperlink{os_8c_ae6e3d966d41303fbdb4e96c6eecd5f33}{S\+Q\+Count} = 0
\item 
volatile \hyperlink{os_8h_ad71fa550e6ad0b4ded3d147641b23d12}{PD} $\ast$ \hyperlink{os_8c_aab867016d4b204788d326f92a91332d0}{Waiting\+Queue} \mbox{[}\hyperlink{os_8h_a06227c0951b6668e376b70760f6ead76}{M\+A\+X\+T\+H\+R\+E\+AD}\mbox{]}
\item 
volatile int \hyperlink{os_8c_ace06abffffb2c8c001691a32cb41f180}{W\+Q\+Count} = 0
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{os.\+c@{os.\+c}!D\+E\+B\+UG@{D\+E\+B\+UG}}
\index{D\+E\+B\+UG@{D\+E\+B\+UG}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{D\+E\+B\+UG}{DEBUG}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+B\+UG}\hypertarget{os_8c_ad72dbcf6d0153db1b8d8a58001feed83}{}\label{os_8c_ad72dbcf6d0153db1b8d8a58001feed83}


Definition at line 8 of file os.\+c.



\subsection{Function Documentation}
\index{os.\+c@{os.\+c}!a\+\_\+main@{a\+\_\+main}}
\index{a\+\_\+main@{a\+\_\+main}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{a\+\_\+main()}{a_main()}}]{\setlength{\rightskip}{0pt plus 5cm}void a\+\_\+main (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_af9c2d0fc011e8984b199e8255ffd9f96}{}\label{os_8c_af9c2d0fc011e8984b199e8255ffd9f96}
Application level main function. Creates the required tasks and then terminates 

Definition at line 317 of file base.\+c.

\index{os.\+c@{os.\+c}!C\+Switch@{C\+Switch}}
\index{C\+Switch@{C\+Switch}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{C\+Switch()}{CSwitch()}}]{\setlength{\rightskip}{0pt plus 5cm}void C\+Switch (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a14f79e1bcaffbf0e0f2e6c4460a61d00}{}\label{os_8c_a14f79e1bcaffbf0e0f2e6c4460a61d00}
This internal kernel function is the context switching mechanism. It consists two halves\+: the top half is called \char`\"{}\+Exit\+\_\+\+Kernel()\char`\"{}, and the bottom half is called \char`\"{}\+Enter\+\_\+\+Kernel()\char`\"{}. When kernel calls this function, it starts the top half (i.\+e., exit). Right in the middle, \char`\"{}\+Cp\char`\"{} is activated; as a result, Cp is running and the kernel is suspended in the middle of this function. When Cp makes a system call, it enters the kernel via the \hyperlink{os_8c_a162ae3bf731cea07532b520836d1338f}{Enter\+\_\+\+Kernel()} software interrupt into the middle of this function, where the kernel was suspended. After executing the bottom half, the context of Cp is saved and the context of the kernel is restore. Hence, when this function returns, kernel is active again, but Cp is not running any more. (See file \char`\"{}cswitch.\+S\char`\"{} for details.) \index{os.\+c@{os.\+c}!Enter\+\_\+\+Kernel@{Enter\+\_\+\+Kernel}}
\index{Enter\+\_\+\+Kernel@{Enter\+\_\+\+Kernel}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Enter\+\_\+\+Kernel()}{Enter_Kernel()}}]{\setlength{\rightskip}{0pt plus 5cm}void Enter\+\_\+\+Kernel (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a162ae3bf731cea07532b520836d1338f}{}\label{os_8c_a162ae3bf731cea07532b520836d1338f}
Contained in cswitch.\+S, context switches to the kernel \index{os.\+c@{os.\+c}!Event\+\_\+\+Init@{Event\+\_\+\+Init}}
\index{Event\+\_\+\+Init@{Event\+\_\+\+Init}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Event\+\_\+\+Init()}{Event_Init()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf E\+V\+E\+NT} Event\+\_\+\+Init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a804f05f767669c8c5ca3afb4b90d99e0}{}\label{os_8c_a804f05f767669c8c5ca3afb4b90d99e0}
Application level event init to setup system call 

Definition at line 711 of file os.\+c.

\index{os.\+c@{os.\+c}!Event\+\_\+\+Signal@{Event\+\_\+\+Signal}}
\index{Event\+\_\+\+Signal@{Event\+\_\+\+Signal}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Event\+\_\+\+Signal(\+E\+V\+E\+N\+T e)}{Event_Signal(EVENT e)}}]{\setlength{\rightskip}{0pt plus 5cm}void Event\+\_\+\+Signal (
\begin{DoxyParamCaption}
\item[{{\bf E\+V\+E\+NT}}]{e}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a82948eaf2be7ba779203ac31df96e5b6}{}\label{os_8c_a82948eaf2be7ba779203ac31df96e5b6}
Application level event signal to setup system call 

Definition at line 735 of file os.\+c.

\index{os.\+c@{os.\+c}!Event\+\_\+\+Wait@{Event\+\_\+\+Wait}}
\index{Event\+\_\+\+Wait@{Event\+\_\+\+Wait}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Event\+\_\+\+Wait(\+E\+V\+E\+N\+T e)}{Event_Wait(EVENT e)}}]{\setlength{\rightskip}{0pt plus 5cm}void Event\+\_\+\+Wait (
\begin{DoxyParamCaption}
\item[{{\bf E\+V\+E\+NT}}]{e}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_adc88c81b804bb7848bb39488ebdac6f9}{}\label{os_8c_adc88c81b804bb7848bb39488ebdac6f9}
Application level event wait to setup system call 

Definition at line 723 of file os.\+c.

\index{os.\+c@{os.\+c}!Exit\+\_\+\+Kernel@{Exit\+\_\+\+Kernel}}
\index{Exit\+\_\+\+Kernel@{Exit\+\_\+\+Kernel}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Exit\+\_\+\+Kernel()}{Exit_Kernel()}}]{\setlength{\rightskip}{0pt plus 5cm}void Exit\+\_\+\+Kernel (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a754288f34793d6c04ab1e008276a8b2e}{}\label{os_8c_a754288f34793d6c04ab1e008276a8b2e}
\index{os.\+c@{os.\+c}!I\+SR@{I\+SR}}
\index{I\+SR@{I\+SR}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{I\+S\+R(\+T\+I\+M\+E\+R1\+\_\+\+C\+O\+M\+P\+A\+\_\+vect)}{ISR(TIMER1_COMPA_vect)}}]{\setlength{\rightskip}{0pt plus 5cm}I\+SR (
\begin{DoxyParamCaption}
\item[{T\+I\+M\+E\+R1\+\_\+\+C\+O\+M\+P\+A\+\_\+vect}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_ad39420cdd896dd12c68e36313139d0a5}{}\label{os_8c_ad39420cdd896dd12c68e36313139d0a5}
I\+SR for timer1 

Definition at line 875 of file os.\+c.

\index{os.\+c@{os.\+c}!I\+SR@{I\+SR}}
\index{I\+SR@{I\+SR}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{I\+S\+R(\+T\+I\+M\+E\+R3\+\_\+\+C\+O\+M\+P\+A\+\_\+vect)}{ISR(TIMER3_COMPA_vect)}}]{\setlength{\rightskip}{0pt plus 5cm}I\+SR (
\begin{DoxyParamCaption}
\item[{T\+I\+M\+E\+R3\+\_\+\+C\+O\+M\+P\+A\+\_\+vect}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a86953738188622410b88938da2bf8a63}{}\label{os_8c_a86953738188622410b88938da2bf8a63}
I\+SR for timer3 

Definition at line 899 of file os.\+c.

\index{os.\+c@{os.\+c}!Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At@{Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At}}
\index{Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At@{Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At(volatile P\+D $\ast$p, voidfuncptr f, P\+R\+I\+O\+R\+I\+T\+Y py, int arg)}{Kernel_Create_Task_At(volatile PD *p, voidfuncptr f, PRIORITY py, int arg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+ID} Kernel\+\_\+\+Create\+\_\+\+Task\+\_\+\+At (
\begin{DoxyParamCaption}
\item[{volatile {\bf PD} $\ast$}]{p, }
\item[{{\bf voidfuncptr}}]{f, }
\item[{{\bf P\+R\+I\+O\+R\+I\+TY}}]{py, }
\item[{int}]{arg}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_ad5a6d9c7b80973c260f856e76414c1de}{}\label{os_8c_ad5a6d9c7b80973c260f856e76414c1de}
Sets up a task\textquotesingle{}s stack with \hyperlink{os_8c_aeb1fcf3f13ebc649c9882f07de88cf74}{Task\+\_\+\+Terminate()} at the bottom, The return address of the function and dummy data to be popped off when the task first runs 

Definition at line 120 of file os.\+c.

\index{os.\+c@{os.\+c}!Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At@{Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At}}
\index{Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At@{Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At(volatile E\+V\+T $\ast$e)}{Kernel_Init_Event_At(volatile EVT *e)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf E\+V\+E\+NT} Kernel\+\_\+\+Init\+\_\+\+Event\+\_\+\+At (
\begin{DoxyParamCaption}
\item[{volatile {\bf E\+VT} $\ast$}]{e}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a7fb955365604100a332d2134acc35a1b}{}\label{os_8c_a7fb955365604100a332d2134acc35a1b}
Initialize an event 

Definition at line 410 of file os.\+c.

\index{os.\+c@{os.\+c}!Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At@{Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At}}
\index{Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At@{Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At(volatile M\+T\+X $\ast$m)}{Kernel_Init_Mutex_At(volatile MTX *m)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+U\+T\+EX} Kernel\+\_\+\+Init\+\_\+\+Mutex\+\_\+\+At (
\begin{DoxyParamCaption}
\item[{volatile {\bf M\+TX} $\ast$}]{m}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a8b771ba833987e328124f40034de1e14}{}\label{os_8c_a8b771ba833987e328124f40034de1e14}
Initialize a mutex 

Definition at line 270 of file os.\+c.

\index{os.\+c@{os.\+c}!main@{main}}
\index{main@{main}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{main()}{main()}}]{\setlength{\rightskip}{0pt plus 5cm}void main (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_acdef7a1fd863a6d3770c1268cb06add3}{}\label{os_8c_acdef7a1fd863a6d3770c1268cb06add3}
This function boots the OS and creates the first task\+: a\+\_\+main 

Definition at line 906 of file os.\+c.

\index{os.\+c@{os.\+c}!Mutex\+\_\+\+Init@{Mutex\+\_\+\+Init}}
\index{Mutex\+\_\+\+Init@{Mutex\+\_\+\+Init}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Mutex\+\_\+\+Init()}{Mutex_Init()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+U\+T\+EX} Mutex\+\_\+\+Init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a44779a076d3264dd26f83ae3e2434450}{}\label{os_8c_a44779a076d3264dd26f83ae3e2434450}
Application level mutex init to setup system call 

Definition at line 674 of file os.\+c.

\index{os.\+c@{os.\+c}!Mutex\+\_\+\+Lock@{Mutex\+\_\+\+Lock}}
\index{Mutex\+\_\+\+Lock@{Mutex\+\_\+\+Lock}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Mutex\+\_\+\+Lock(\+M\+U\+T\+E\+X m)}{Mutex_Lock(MUTEX m)}}]{\setlength{\rightskip}{0pt plus 5cm}void Mutex\+\_\+\+Lock (
\begin{DoxyParamCaption}
\item[{{\bf M\+U\+T\+EX}}]{m}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a192517b3428c686a32293805abd120f1}{}\label{os_8c_a192517b3428c686a32293805abd120f1}
Application level mutex lock to setup system call 

Definition at line 686 of file os.\+c.

\index{os.\+c@{os.\+c}!Mutex\+\_\+\+Unlock@{Mutex\+\_\+\+Unlock}}
\index{Mutex\+\_\+\+Unlock@{Mutex\+\_\+\+Unlock}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Mutex\+\_\+\+Unlock(\+M\+U\+T\+E\+X m)}{Mutex_Unlock(MUTEX m)}}]{\setlength{\rightskip}{0pt plus 5cm}void Mutex\+\_\+\+Unlock (
\begin{DoxyParamCaption}
\item[{{\bf M\+U\+T\+EX}}]{m}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_ac614666cf2c6345ff7e15ceb2e96e8dc}{}\label{os_8c_ac614666cf2c6345ff7e15ceb2e96e8dc}
Application level mutex unlock to setup system call 

Definition at line 699 of file os.\+c.

\index{os.\+c@{os.\+c}!O\+S\+\_\+\+Abort@{O\+S\+\_\+\+Abort}}
\index{O\+S\+\_\+\+Abort@{O\+S\+\_\+\+Abort}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{O\+S\+\_\+\+Abort()}{OS_Abort()}}]{\setlength{\rightskip}{0pt plus 5cm}void O\+S\+\_\+\+Abort (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a40cd786f232d0c4af0952cfc037addc6}{}\label{os_8c_a40cd786f232d0c4af0952cfc037addc6}
Just quits 

Definition at line 667 of file os.\+c.

\index{os.\+c@{os.\+c}!O\+S\+\_\+\+Init@{O\+S\+\_\+\+Init}}
\index{O\+S\+\_\+\+Init@{O\+S\+\_\+\+Init}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{O\+S\+\_\+\+Init()}{OS_Init()}}]{\setlength{\rightskip}{0pt plus 5cm}void O\+S\+\_\+\+Init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a280149a9407c6504ce0af541351561db}{}\label{os_8c_a280149a9407c6504ce0af541351561db}
This function initializes the R\+T\+OS and must be called first 

Definition at line 624 of file os.\+c.

\index{os.\+c@{os.\+c}!O\+S\+\_\+\+Start@{O\+S\+\_\+\+Start}}
\index{O\+S\+\_\+\+Start@{O\+S\+\_\+\+Start}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{O\+S\+\_\+\+Start()}{OS_Start()}}]{\setlength{\rightskip}{0pt plus 5cm}void O\+S\+\_\+\+Start (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_ad962d6cd4a1df43af8ab0aabe2fd5e03}{}\label{os_8c_ad962d6cd4a1df43af8ab0aabe2fd5e03}
This function starts the R\+T\+OS after creating a\+\_\+main 

Definition at line 654 of file os.\+c.

\index{os.\+c@{os.\+c}!setup@{setup}}
\index{setup@{setup}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{setup()}{setup()}}]{\setlength{\rightskip}{0pt plus 5cm}void setup (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a4fc01d736fe50cf5b977f755b675f11d}{}\label{os_8c_a4fc01d736fe50cf5b977f755b675f11d}
Setup pins and timers initialize Timer1 16 bit timer

Timer 1

Set T\+C\+C\+R1A register to 0

Set T\+C\+C\+R1B register to 0

Initialize counter to 0

Compare match register (T\+OP comparison value) \mbox{[}(16\+M\+Hz/(100\+Hz$\ast$8)\mbox{]} -\/ 1

Turns on C\+TC mode (T\+OP is now O\+C\+R1A)

Prescaler 256

Enable timer compare interrupt

Timer 3

Set T\+C\+C\+R0A register to 0

Set T\+C\+C\+R0B register to 0

Initialize counter to 0

Compare match register (T\+OP comparison value) \mbox{[}(16\+M\+Hz/(100\+Hz$\ast$8)\mbox{]} -\/ 1

Turns on C\+TC mode (T\+OP is now O\+C\+R1A)

Prescaler 1024 

Definition at line 836 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Create@{Task\+\_\+\+Create}}
\index{Task\+\_\+\+Create@{Task\+\_\+\+Create}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Create(voidfuncptr f, P\+R\+I\+O\+R\+I\+T\+Y py, int arg)}{Task_Create(voidfuncptr f, PRIORITY py, int arg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\+ID} Task\+\_\+\+Create (
\begin{DoxyParamCaption}
\item[{{\bf voidfuncptr}}]{f, }
\item[{{\bf P\+R\+I\+O\+R\+I\+TY}}]{py, }
\item[{int}]{arg}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_afed6faf3ae1b6be2a43f5f43c4e53250}{}\label{os_8c_afed6faf3ae1b6be2a43f5f43c4e53250}
Application or kernel level task create to setup system call 

Definition at line 747 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Get\+Arg@{Task\+\_\+\+Get\+Arg}}
\index{Task\+\_\+\+Get\+Arg@{Task\+\_\+\+Get\+Arg}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Get\+Arg(\+P\+I\+D p)}{Task_GetArg(PID p)}}]{\setlength{\rightskip}{0pt plus 5cm}int Task\+\_\+\+Get\+Arg (
\begin{DoxyParamCaption}
\item[{{\bf P\+ID}}]{p}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_ae9e552294bff300b4c4f4e5a010ee735}{}\label{os_8c_ae9e552294bff300b4c4f4e5a010ee735}
Application level task getarg to return intiial arg value 

Definition at line 829 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Next@{Task\+\_\+\+Next}}
\index{Task\+\_\+\+Next@{Task\+\_\+\+Next}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Next()}{Task_Next()}}]{\setlength{\rightskip}{0pt plus 5cm}void Task\+\_\+\+Next (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a5a9b72d0dadaea32fec8d4ff1c0eafa4}{}\label{os_8c_a5a9b72d0dadaea32fec8d4ff1c0eafa4}
Application level task next to setup system call to give up C\+PU 

Definition at line 768 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Resume@{Task\+\_\+\+Resume}}
\index{Task\+\_\+\+Resume@{Task\+\_\+\+Resume}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Resume(\+P\+I\+D p)}{Task_Resume(PID p)}}]{\setlength{\rightskip}{0pt plus 5cm}void Task\+\_\+\+Resume (
\begin{DoxyParamCaption}
\item[{{\bf P\+ID}}]{p}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a6bbdbd6cb63924353074e64134deff60}{}\label{os_8c_a6bbdbd6cb63924353074e64134deff60}
Application level task resume to setup system call 

Definition at line 805 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Sleep@{Task\+\_\+\+Sleep}}
\index{Task\+\_\+\+Sleep@{Task\+\_\+\+Sleep}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Sleep(\+T\+I\+C\+K t)}{Task_Sleep(TICK t)}}]{\setlength{\rightskip}{0pt plus 5cm}void Task\+\_\+\+Sleep (
\begin{DoxyParamCaption}
\item[{{\bf T\+I\+CK}}]{t}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a312c9c8228404b24b021279387a7c774}{}\label{os_8c_a312c9c8228404b24b021279387a7c774}
Application level task sleep to setup system call 

Definition at line 779 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Suspend@{Task\+\_\+\+Suspend}}
\index{Task\+\_\+\+Suspend@{Task\+\_\+\+Suspend}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Suspend(\+P\+I\+D p)}{Task_Suspend(PID p)}}]{\setlength{\rightskip}{0pt plus 5cm}void Task\+\_\+\+Suspend (
\begin{DoxyParamCaption}
\item[{{\bf P\+ID}}]{p}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_a8d86c9b6abd886dc6dc8005808d219e6}{}\label{os_8c_a8d86c9b6abd886dc6dc8005808d219e6}
Application level task suspend to setup system call 

Definition at line 793 of file os.\+c.

\index{os.\+c@{os.\+c}!Task\+\_\+\+Terminate@{Task\+\_\+\+Terminate}}
\index{Task\+\_\+\+Terminate@{Task\+\_\+\+Terminate}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Task\+\_\+\+Terminate(void)}{Task_Terminate(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Task\+\_\+\+Terminate (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{os_8c_aeb1fcf3f13ebc649c9882f07de88cf74}{}\label{os_8c_aeb1fcf3f13ebc649c9882f07de88cf74}
Prototypes

Application level task terminate to setup system call 

Definition at line 817 of file os.\+c.



\subsection{Variable Documentation}
\index{os.\+c@{os.\+c}!Current\+Sp@{Current\+Sp}}
\index{Current\+Sp@{Current\+Sp}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Current\+Sp}{CurrentSp}}]{\setlength{\rightskip}{0pt plus 5cm}volatile unsigned char$\ast$ Current\+Sp}\hypertarget{os_8c_a5f93aafc340cf74d6d1389f53cfdce23}{}\label{os_8c_a5f93aafc340cf74d6d1389f53cfdce23}
This is a \char`\"{}shadow\char`\"{} copy of the stack pointer of \char`\"{}\+Cp\char`\"{}, the currently running task. During context switching, we need to save and restore it into the appropriate process descriptor. 

Definition at line 83 of file os.\+c.

\index{os.\+c@{os.\+c}!Kernel\+Sp@{Kernel\+Sp}}
\index{Kernel\+Sp@{Kernel\+Sp}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Kernel\+Sp}{KernelSp}}]{\setlength{\rightskip}{0pt plus 5cm}volatile unsigned char$\ast$ Kernel\+Sp}\hypertarget{os_8c_a0841513918201502036fc51005a17411}{}\label{os_8c_a0841513918201502036fc51005a17411}
Since this is a \char`\"{}full-\/served\char`\"{} model, the kernel is executing using its own stack. We can allocate a new workspace for this kernel stack, or we can use the stack of the \char`\"{}main()\char`\"{} function, i.\+e., the initial C runtime stack. (Note\+: This and the following stack pointers are used primarily by the context switching code, i.\+e., \hyperlink{os_8c_a14f79e1bcaffbf0e0f2e6c4460a61d00}{C\+Switch()}, which is written in assembly language.) 

Definition at line 76 of file os.\+c.

\index{os.\+c@{os.\+c}!Ready\+Queue@{Ready\+Queue}}
\index{Ready\+Queue@{Ready\+Queue}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Ready\+Queue}{ReadyQueue}}]{\setlength{\rightskip}{0pt plus 5cm}volatile {\bf PD}$\ast$ Ready\+Queue\mbox{[}{\bf M\+A\+X\+T\+H\+R\+E\+AD}\mbox{]}}\hypertarget{os_8c_a4a9c7eec21f25437a89e349d66608937}{}\label{os_8c_a4a9c7eec21f25437a89e349d66608937}
The Ready\+Queue for tasks 

Definition at line 104 of file os.\+c.

\index{os.\+c@{os.\+c}!R\+Q\+Count@{R\+Q\+Count}}
\index{R\+Q\+Count@{R\+Q\+Count}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{R\+Q\+Count}{RQCount}}]{\setlength{\rightskip}{0pt plus 5cm}volatile int R\+Q\+Count = 0}\hypertarget{os_8c_a96957c6dd13db4430799fff38a54f151}{}\label{os_8c_a96957c6dd13db4430799fff38a54f151}


Definition at line 105 of file os.\+c.

\index{os.\+c@{os.\+c}!Sleep\+Queue@{Sleep\+Queue}}
\index{Sleep\+Queue@{Sleep\+Queue}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Sleep\+Queue}{SleepQueue}}]{\setlength{\rightskip}{0pt plus 5cm}volatile {\bf PD}$\ast$ Sleep\+Queue\mbox{[}{\bf M\+A\+X\+T\+H\+R\+E\+AD}\mbox{]}}\hypertarget{os_8c_a94c6daa6fecf3677de9e1471e294baa6}{}\label{os_8c_a94c6daa6fecf3677de9e1471e294baa6}
The Sleep\+Queue for tasks 

Definition at line 108 of file os.\+c.

\index{os.\+c@{os.\+c}!S\+Q\+Count@{S\+Q\+Count}}
\index{S\+Q\+Count@{S\+Q\+Count}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{S\+Q\+Count}{SQCount}}]{\setlength{\rightskip}{0pt plus 5cm}volatile int S\+Q\+Count = 0}\hypertarget{os_8c_ae6e3d966d41303fbdb4e96c6eecd5f33}{}\label{os_8c_ae6e3d966d41303fbdb4e96c6eecd5f33}


Definition at line 109 of file os.\+c.

\index{os.\+c@{os.\+c}!tick\+Overflow\+Count@{tick\+Overflow\+Count}}
\index{tick\+Overflow\+Count@{tick\+Overflow\+Count}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{tick\+Overflow\+Count}{tickOverflowCount}}]{\setlength{\rightskip}{0pt plus 5cm}volatile unsigned int tick\+Overflow\+Count = 0}\hypertarget{os_8c_a855e060cb1ab82756c5688c661ec7872}{}\label{os_8c_a855e060cb1ab82756c5688c661ec7872}
Global tick overflow count 

Definition at line 101 of file os.\+c.

\index{os.\+c@{os.\+c}!Waiting\+Queue@{Waiting\+Queue}}
\index{Waiting\+Queue@{Waiting\+Queue}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{Waiting\+Queue}{WaitingQueue}}]{\setlength{\rightskip}{0pt plus 5cm}volatile {\bf PD}$\ast$ Waiting\+Queue\mbox{[}{\bf M\+A\+X\+T\+H\+R\+E\+AD}\mbox{]}}\hypertarget{os_8c_aab867016d4b204788d326f92a91332d0}{}\label{os_8c_aab867016d4b204788d326f92a91332d0}
The Waiting\+Queue for tasks 

Definition at line 112 of file os.\+c.

\index{os.\+c@{os.\+c}!W\+Q\+Count@{W\+Q\+Count}}
\index{W\+Q\+Count@{W\+Q\+Count}!os.\+c@{os.\+c}}
\subsubsection[{\texorpdfstring{W\+Q\+Count}{WQCount}}]{\setlength{\rightskip}{0pt plus 5cm}volatile int W\+Q\+Count = 0}\hypertarget{os_8c_ace06abffffb2c8c001691a32cb41f180}{}\label{os_8c_ace06abffffb2c8c001691a32cb41f180}


Definition at line 113 of file os.\+c.

